<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dynamic TFM (immune cells) &mdash; saenopy 1.0.6 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-rendered-html.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Microbeads to Detect Matrix Deformations" href="3_BeadMeasurement.html" />
    <link rel="prev" title="Classic TFM (liver fibroblasts)" href="1_SingleCellTFM.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            saenopy
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../interface.html">Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../boundarycondition.html">Boundary Condition Mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="../regularization.html">Regularization Mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mesh.html">Mesh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../material.html">Material</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="1_SingleCellTFM.html">Classic TFM (liver fibroblasts)</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Dynamic TFM (immune cells)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#downloading-the-example-data-files">Downloading the example data files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#loading-the-stacks">Loading the Stacks</a></li>
<li class="toctree-l3"><a class="reference internal" href="#detecting-the-deformations">Detecting the Deformations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#visualizing-results">Visualizing Results</a></li>
<li class="toctree-l3"><a class="reference internal" href="#generating-the-finite-element-mesh">Generating the Finite Element Mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="#calculating-the-forces">Calculating the Forces</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="3_BeadMeasurement.html">Microbeads to Detect Matrix Deformations</a></li>
<li class="toctree-l2"><a class="reference internal" href="4_OrganoidTFM.html">Multicellular TFM (intestinal organoids)</a></li>
<li class="toctree-l2"><a class="reference internal" href="6_BrightfieldTFM.html">Brightfield TFM &amp; Cropped Input</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ReadInData.html">Read Files with Pyhton</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">saenopy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Examples</a></li>
      <li class="breadcrumb-item active">Dynamic TFM (immune cells)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/auto_examples/2_DynamicalSingleCellTFM.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-examples-2-dynamicalsinglecelltfm-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="dynamic-tfm-immune-cells">
<span id="sphx-glr-auto-examples-2-dynamicalsinglecelltfm-py"></span><h1>Dynamic TFM (immune cells)<a class="headerlink" href="#dynamic-tfm-immune-cells" title="Permalink to this heading">¶</a></h1>
<p>This example evaluates a single natural killer cell that migrated through 1.2mg/ml collagen, recorded for 24min.</p>
<blockquote>
<div><figure class="align-center">
<a class="reference internal image-reference" href="../_images/Gif_nk_dynamic_example.gif"><img alt="../_images/Gif_nk_dynamic_example.gif" src="../_images/Gif_nk_dynamic_example.gif" style="width: 409.6px; height: 307.20000000000005px;" /></a>
</figure>
</div></blockquote>
<p>This example can also be evaluated with the graphical user interface.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">21</span> <span class="kn">import</span><span class="w"> </span><span class="nn">saenopy</span>
</pre></div>
</div>
<section id="downloading-the-example-data-files">
<h2>Downloading the example data files<a class="headerlink" href="#downloading-the-example-data-files" title="Permalink to this heading">¶</a></h2>
<p>The folder structure is as follows. There is one position recorded in the gel (Pos002) and two
channels (ch00, ch01). The stack has 162 z positions (z000-z161). The position is recorded for 24 time steps
(t00-t23).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>2_DynamicalSingleCellTFM
└── data
    ├── Pos002_S001_t00_z000_ch00.tif
    ├── Pos002_S001_t00_z000_ch01.tif
    ├── Pos002_S001_t00_z001_ch00.tif
    ├── Pos002_S001_t00_z001_ch01.tif
    ├── Pos002_S001_t00_z002_ch00.tif
    ├── ...
    ├── Pos002_S001_t01_z000_ch00.tif
    ├── Pos002_S001_t01_z000_ch01.tif
    ├── Pos002_S001_t01_z001_ch00.tif
    └── ...
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">47</span> <span class="c1"># download the data</span>
<span class="linenos">48</span> <span class="n">saenopy</span><span class="o">.</span><span class="n">load_example</span><span class="p">(</span><span class="s2">&quot;DynamicalSingleCellTFM&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="loading-the-stacks">
<h2>Loading the Stacks<a class="headerlink" href="#loading-the-stacks" title="Permalink to this heading">¶</a></h2>
<p>Saenopy is very flexible in loading stacks from any filename structure.
Here we do not have multiple positions, so we do not need to use and asterisk * for batch processing.
We replace the number of the channels “ch00” with a channel placeholder “ch{c:00}” to indicate that this refers to
the channels and which channel to use as the first channel where the deformations should be detected.
We replace the number of the z slice “z000” with a z placeholder “z{z}” to indicate that this number refers to the
z slice.
We replace the number of the time step “t00” with a time placeholder “t{t}” to indicate that this number refers to the
time step.
Due to technical reasons and the soft nature of collagen hydrogels,
acquiring fast image stacks  with our galvo stage (within 10 seconds) can cause external motion
in the upper and lower region the image stack, as the stage accelerates and
decelerates here. Therefore, we always acquire a larger stack in z-direction and then discard
the upper and lower regions (20 images here).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">69</span> <span class="c1"># load the relaxed and the contracted stack</span>
<span class="linenos">70</span> <span class="c1"># {z} is the placeholder for the z stack</span>
<span class="linenos">71</span> <span class="c1"># {c} is the placeholder for the channels</span>
<span class="linenos">72</span> <span class="c1"># {t} is the placeholder for the time points</span>
<span class="linenos">73</span>
<span class="linenos">74</span> <span class="n">results</span> <span class="o">=</span> <span class="n">saenopy</span><span class="o">.</span><span class="n">get_stacks</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;2_DynamicalSingleCellTFM\data\Pos*_S001_t</span><span class="si">{t}</span><span class="s1">_z</span><span class="si">{z}</span><span class="s1">_ch</span><span class="si">{c:00}</span><span class="s1">.tif&#39;</span><span class="p">,</span>
<span class="linenos">75</span>                              <span class="sa">r</span><span class="s1">&#39;2_DynamicalSingleCellTFM\example_output&#39;</span><span class="p">,</span>
<span class="linenos">76</span>                              <span class="n">voxel_size</span><span class="o">=</span><span class="p">[</span><span class="mf">0.2407</span><span class="p">,</span> <span class="mf">0.2407</span><span class="p">,</span> <span class="mf">1.0071</span><span class="p">],</span>
<span class="linenos">77</span>                              <span class="n">time_delta</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span>
<span class="linenos">78</span>                              <span class="n">crop</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">)}</span>
<span class="linenos">79</span>                              <span class="p">)</span>
</pre></div>
</div>
</section>
<section id="detecting-the-deformations">
<h2>Detecting the Deformations<a class="headerlink" href="#detecting-the-deformations" title="Permalink to this heading">¶</a></h2>
<figure class="align-default">
<img alt="../_images/nk_dynamic_stacks.png" src="../_images/nk_dynamic_stacks.png" />
</figure>
<p>Saenopy uses 3D Particle Image Velocimetry (PIV) to calculate the collagen matrix deformations
generated by the natural killer cell at different times. For this, we use the following parameters.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Piv Parameter</p></th>
<th class="head"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>element_size</p></td>
<td><p>4</p></td>
</tr>
<tr class="row-odd"><td><p>window_size</p></td>
<td><p>12</p></td>
</tr>
<tr class="row-even"><td><p>signal_to_noise</p></td>
<td><p>1.3</p></td>
</tr>
<tr class="row-odd"><td><p>drift_correction</p></td>
<td><p>True</p></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">104</span> <span class="c1"># define the parameters for the piv deformation detection</span>
<span class="linenos">105</span> <span class="n">piv_parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;element_size&#39;</span><span class="p">:</span> <span class="mf">4.0</span><span class="p">,</span> <span class="s1">&#39;window_size&#39;</span><span class="p">:</span> <span class="mf">12.0</span><span class="p">,</span> <span class="s1">&#39;signal_to_noise&#39;</span><span class="p">:</span> <span class="mf">1.3</span><span class="p">,</span> <span class="s1">&#39;drift_correction&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
<span class="linenos">106</span>
<span class="linenos">107</span>
<span class="linenos">108</span> <span class="c1"># iterate over all the results objects</span>
<span class="linenos">109</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
<span class="linenos">110</span>     <span class="c1"># set the parameters</span>
<span class="linenos">111</span>     <span class="n">result</span><span class="o">.</span><span class="n">piv_parameters</span> <span class="o">=</span> <span class="n">piv_parameters</span>
<span class="linenos">112</span>     <span class="c1"># get count</span>
<span class="linenos">113</span>     <span class="n">count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">stacks</span><span class="p">)</span>
<span class="linenos">114</span>     <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">stack_reference</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos">115</span>         <span class="n">count</span> <span class="o">-=</span> <span class="mi">1</span>
<span class="linenos">116</span>     <span class="c1"># iterate over all stack pairs</span>
<span class="linenos">117</span>     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">count</span><span class="p">):</span>
<span class="linenos">118</span>         <span class="c1"># get two consecutive stacks</span>
<span class="linenos">119</span>         <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">stack_reference</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos">120</span>             <span class="n">stack1</span><span class="p">,</span> <span class="n">stack2</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">stacks</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">result</span><span class="o">.</span><span class="n">stacks</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
<span class="linenos">121</span>         <span class="c1"># or reference stack and one from the list</span>
<span class="linenos">122</span>         <span class="k">else</span><span class="p">:</span>
<span class="linenos">123</span>             <span class="n">stack1</span><span class="p">,</span> <span class="n">stack2</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">stack_reference</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">stacks</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="linenos">124</span>
<span class="linenos">125</span>         <span class="c1"># due to the acceleration of the galvo stage there can be shaking in the</span>
<span class="linenos">126</span>         <span class="c1"># lower or upper part of the stack. Therefore, we recorded larger</span>
<span class="linenos">127</span>         <span class="c1"># z-regions and then discard the upper or lower parts</span>
<span class="linenos">128</span>
<span class="linenos">129</span>         <span class="c1"># and calculate the displacement between them</span>
<span class="linenos">130</span>         <span class="n">result</span><span class="o">.</span><span class="n">mesh_piv</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">saenopy</span><span class="o">.</span><span class="n">get_displacements_from_stacks</span><span class="p">(</span><span class="n">stack1</span><span class="p">,</span> <span class="n">stack2</span><span class="p">,</span>
<span class="linenos">131</span>                                                                     <span class="n">piv_parameters</span><span class="p">[</span><span class="s2">&quot;window_size&quot;</span><span class="p">],</span>
<span class="linenos">132</span>                                                                     <span class="n">piv_parameters</span><span class="p">[</span><span class="s2">&quot;element_size&quot;</span><span class="p">],</span>
<span class="linenos">133</span>                                                                     <span class="n">piv_parameters</span><span class="p">[</span><span class="s2">&quot;signal_to_noise&quot;</span><span class="p">],</span>
<span class="linenos">134</span>                                                                     <span class="n">piv_parameters</span><span class="p">[</span><span class="s2">&quot;drift_correction&quot;</span><span class="p">])</span>
<span class="linenos">135</span>     <span class="c1"># save the displacements</span>
<span class="linenos">136</span>     <span class="n">result</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="visualizing-results">
<h2>Visualizing Results<a class="headerlink" href="#visualizing-results" title="Permalink to this heading">¶</a></h2>
<p>You can save the resulting 3D fields by simply using the <strong>export image</strong> dialog.
Here we underlay a bright field image of the cell for a better overview
and export a <strong>.gif</strong> file</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/nk_dynamic_piv_export_4fps.gif"><img alt="../_images/nk_dynamic_piv_export_4fps.gif" src="../_images/nk_dynamic_piv_export_4fps.gif" style="width: 280.0px; height: 360.0px;" /></a>
</figure>
</section>
<section id="generating-the-finite-element-mesh">
<h2>Generating the Finite Element Mesh<a class="headerlink" href="#generating-the-finite-element-mesh" title="Permalink to this heading">¶</a></h2>
<p>Interpolate the found deformations onto a new mesh which will be used for the regularisation. We use the same element
size of deformation detection mesh here and we also keep the overall mesh size the same. We define that as an
undeformed reference we want to use the median of all stacks.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Mesh Parameter</p></th>
<th class="head"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>reference_stack</p></td>
<td><p>median</p></td>
</tr>
<tr class="row-odd"><td><p>element_size</p></td>
<td><p>4</p></td>
</tr>
<tr class="row-even"><td><p>mesh_size</p></td>
<td><p>“piv”</p></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">170</span> <span class="c1"># define the parameters to generate the solver mesh and interpolate the piv mesh onto it</span>
<span class="linenos">171</span> <span class="n">mesh_parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;reference_stack&#39;</span><span class="p">:</span> <span class="s1">&#39;median&#39;</span><span class="p">,</span> <span class="s1">&#39;element_size&#39;</span><span class="p">:</span> <span class="mf">4.0</span><span class="p">,</span> <span class="s1">&#39;mesh_size&#39;</span><span class="p">:</span> <span class="s2">&quot;piv&quot;</span><span class="p">}</span>
<span class="linenos">172</span>
<span class="linenos">173</span> <span class="c1"># iterate over all the results objects</span>
<span class="linenos">174</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
<span class="linenos">175</span>     <span class="c1"># correct for the reference state</span>
<span class="linenos">176</span>     <span class="n">displacement_list</span> <span class="o">=</span> <span class="n">saenopy</span><span class="o">.</span><span class="n">subtract_reference_state</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">mesh_piv</span><span class="p">,</span> <span class="n">mesh_parameters</span><span class="p">[</span><span class="s2">&quot;reference_stack&quot;</span><span class="p">])</span>
<span class="linenos">177</span>     <span class="c1"># set the parameters</span>
<span class="linenos">178</span>     <span class="n">result</span><span class="o">.</span><span class="n">mesh_parameters</span> <span class="o">=</span> <span class="n">mesh_parameters</span>
<span class="linenos">179</span>     <span class="c1"># iterate over all stack pairs</span>
<span class="linenos">180</span>     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">mesh_piv</span><span class="p">)):</span>
<span class="linenos">181</span>         <span class="c1"># and create the interpolated solver mesh</span>
<span class="linenos">182</span>         <span class="n">result</span><span class="o">.</span><span class="n">solvers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">saenopy</span><span class="o">.</span><span class="n">interpolate_mesh</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">mesh_piv</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">displacement_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">mesh_parameters</span><span class="p">)</span>
<span class="linenos">183</span>     <span class="c1"># save the meshes</span>
<span class="linenos">184</span>     <span class="n">result</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="calculating-the-forces">
<h2>Calculating the Forces<a class="headerlink" href="#calculating-the-forces" title="Permalink to this heading">¶</a></h2>
<p>Define the material model and run the regularisation to fit the measured deformations and get the forces.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Material Parameter</p></th>
<th class="head"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>k</p></td>
<td><p>1449</p></td>
</tr>
<tr class="row-odd"><td><p>d_0</p></td>
<td><p>0.0022</p></td>
</tr>
<tr class="row-even"><td><p>lambda_s</p></td>
<td><p>0.032</p></td>
</tr>
<tr class="row-odd"><td><p>d_s</p></td>
<td><p>0.055</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Regularisation Parameter</p></th>
<th class="head"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>alpha</p></td>
<td><p>10**10</p></td>
</tr>
<tr class="row-odd"><td><p>step_size</p></td>
<td><p>0.33</p></td>
</tr>
<tr class="row-even"><td><p>max_iterations</p></td>
<td><p>100</p></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">214</span> <span class="c1"># define the parameters to generate the solver mesh and interpolate the piv mesh onto it</span>
<span class="linenos">215</span> <span class="n">material_parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;k&#39;</span><span class="p">:</span> <span class="mf">1449.0</span><span class="p">,</span> <span class="s1">&#39;d_0&#39;</span><span class="p">:</span> <span class="mf">0.0022</span><span class="p">,</span> <span class="s1">&#39;lambda_s&#39;</span><span class="p">:</span> <span class="mf">0.032</span><span class="p">,</span> <span class="s1">&#39;d_s&#39;</span><span class="p">:</span> <span class="mf">0.055</span><span class="p">}</span>
<span class="linenos">216</span> <span class="n">solve_parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;alpha&#39;</span><span class="p">:</span>  <span class="mi">10</span><span class="o">**</span><span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;step_size&#39;</span><span class="p">:</span> <span class="mf">0.33</span><span class="p">,</span> <span class="s1">&#39;max_iterations&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">}</span>
<span class="linenos">217</span>
<span class="linenos">218</span>
<span class="linenos">219</span> <span class="c1"># iterate over all the results objects</span>
<span class="linenos">220</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
<span class="linenos">221</span>     <span class="n">result</span><span class="o">.</span><span class="n">material_parameters</span> <span class="o">=</span> <span class="n">material_parameters</span>
<span class="linenos">222</span>     <span class="n">result</span><span class="o">.</span><span class="n">solve_parameters</span> <span class="o">=</span> <span class="n">solve_parameters</span>
<span class="linenos">223</span>     <span class="k">for</span> <span class="n">M</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">solvers</span><span class="p">:</span>
<span class="linenos">224</span>         <span class="c1"># set the material model</span>
<span class="linenos">225</span>         <span class="n">M</span><span class="o">.</span><span class="n">set_material_model</span><span class="p">(</span><span class="n">saenopy</span><span class="o">.</span><span class="n">materials</span><span class="o">.</span><span class="n">SemiAffineFiberMaterial</span><span class="p">(</span>
<span class="linenos">226</span>             <span class="n">material_parameters</span><span class="p">[</span><span class="s2">&quot;k&quot;</span><span class="p">],</span>
<span class="linenos">227</span>             <span class="n">material_parameters</span><span class="p">[</span><span class="s2">&quot;d_0&quot;</span><span class="p">],</span>
<span class="linenos">228</span>             <span class="n">material_parameters</span><span class="p">[</span><span class="s2">&quot;lambda_s&quot;</span><span class="p">],</span>
<span class="linenos">229</span>             <span class="n">material_parameters</span><span class="p">[</span><span class="s2">&quot;d_s&quot;</span><span class="p">],</span>
<span class="linenos">230</span>         <span class="p">))</span>
<span class="linenos">231</span>         <span class="c1"># find the regularized force solution</span>
<span class="linenos">232</span>         <span class="n">M</span><span class="o">.</span><span class="n">solve_regularized</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">solve_parameters</span><span class="p">[</span><span class="s2">&quot;alpha&quot;</span><span class="p">],</span> <span class="n">step_size</span><span class="o">=</span><span class="n">solve_parameters</span><span class="p">[</span><span class="s2">&quot;step_size&quot;</span><span class="p">],</span>
<span class="linenos">233</span>                             <span class="n">max_iterations</span><span class="o">=</span><span class="n">solve_parameters</span><span class="p">[</span><span class="s2">&quot;max_iterations&quot;</span><span class="p">],</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos">234</span>     <span class="c1"># save the forces</span>
<span class="linenos">235</span>     <span class="n">result</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-2-dynamicalsinglecelltfm-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/4f6ec57694841fa2a1194167c2e6bd5f/2_DynamicalSingleCellTFM.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">2_DynamicalSingleCellTFM.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/7ff94dc0c0d4dfbef1fd5f826934f81a/2_DynamicalSingleCellTFM.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">2_DynamicalSingleCellTFM.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="1_SingleCellTFM.html" class="btn btn-neutral float-left" title="Classic TFM (liver fibroblasts)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="3_BeadMeasurement.html" class="btn btn-neutral float-right" title="Microbeads to Detect Matrix Deformations" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019-2023, Richard Gerum, David Böhringer.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>